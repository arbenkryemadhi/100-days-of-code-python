Fix the code for all cases